# NATとPATの検証
NAT, PATの設定が適切かどうか検証するには、NATテーブルや統計情報を確認する。デバッグを使用するとアドレス変換の様子をリアルタイムに確認できる

### `NATの検証`
NATの設定が完了したら、下記コマンドで検証する必要がある。  
`show ip translations`  
`show ip nat statistics`  
`show access-lists`  
`clear ip nat translation`  
`debug ip nat`(必要な場合のみ)

- NATテーブルの表示  
NATテーブルを表示するには`show ip nat translations`コマンドを使用する。スタティックNATを設定すると、変換エントリが永続的に登録される。ダイナミックNATでは、変換対象パケットの受信によってアドレス変換が実行されると、エントリが動的に追加される。内部ホスト(Inside local)から外部ホスト宛の変換対象パケットを受信したことによるアドレス変化を示す。  
**NATテーブルの表示(mode:>, #)**  
`#show ip nat translations`  
Pro:プロトコル名  
Inside global:内部グローバルアドレス  
Inside local:内部ローカルアドレス  
Outside local:外部ローカルアドレス  
Outside global:外部グローバルアドレス

- NAT統計情報の表示  
`show ip nat statistics`コマンドは、NATの統計情報を表示する。アドレス変換を実行した回数や変換に失敗した回数などの統計情報の他に、inside / outsideインターフェイス、NATプール、ダイナミックNATの設定情報も確認できる。ヒットカウンタはNATテーブルのエントリを検索して実行されたアドレス変換ごとに増加し続ける。統計情報をクリアしたい場合、特権EXECモードで先頭にclearをつけて実行する。出力内容は以下の通り。  
・アクティブな変換エントリの数  
・ピーク時の変換エントリ数  
・外部ネットワークを指定したインターフェイス  
・内部ネットワークを指定したインターフェイス  
・アドレス変換に成功、失敗した回数  
・CEFで高速にスイッチングされたパケットの数  
・タイムアウトによってクリアされた変換エントリの数  
・ダイナミックNAT(PAT)の設定情報。未設定の場合、以降は表示されない  
・inside sourceの設定で、ACLとプールを定義し、現在の参照カウント数を表示  
・プールで定義されたサブネットマスク  
・プールで定義されたアドレスの範囲  
・プールで定義されたアドレス数、割り当てた数、変換に失敗した数

- アクセスリストの表示  
ip nat source listコマンドで指定したACLの内容を確認するためには、`show access-lists`コマンドでACLを表示する。ACLに含まれるpermitの条件に一致した場合、ステートメントの最後にパケット数が表示される。

- NATテーブルのエントリ消去

- ダイナミックNAT変換エントリのタイムアウト設定

### `NATの動作検証(デバッグ)`

---
> スタティックNATの場合、設定コマンドが消去されるまでNATテーブルに登録され続ける。
