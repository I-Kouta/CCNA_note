# パスワードによる管理アクセスの保護
ルータやスイッチなどの保護は、ネットワーク全体のセキュリティ向上につながり、管理アクセス(管理接続)を保護する基本的なパスワード設定が必要。ルータとスイッチも共通のコマンド

### `EXECモードのパスワード保護`
シスコのルータやスイッチへの管理アクセスには、一般にコンソールポートやVTY(仮装端末)ポートを使用してログインする。それぞれの回線設定モードに対してパスワードを設定し、それぞれのタイミングでパスワード入力することができる。

### `コンソールパスワード`
コンソールポートに対するパスワードのこと。コンソールポートから管理アクセスを試みたときにパスワードを入力するプロンプトが表示され、正しくないとユーザEXECモードに移行することはできない。  
**コンソールパスワードの設定**  
`(config)#line console 0`  
`(config-line)#password <password>`  
`(config-line)#login`  
password:パスワード文字列を設定。大文字小文字の区別あり  
login:ログイン時のパスワードチェックを有効にする  
コンソールポートは1つだけなので、ライン番号は常に0を指定。loginコマンドはパスワードによるコンソール認証を有効化するための設定。コンソール接続の際にパスワードを要求させるには**password**コマンドと**login**コマンドの両方が必要。**no login**コマンドで無効にしている場合、passwordコマンドを設定していてもパスワード要求はない。no passwordコマンドでパスワードを削除すると、loginコマンドが有効でもパスワード要求はない。IOSではキーボードから入力パスワードは画面上に表示されない。回線(ライン)の設定は、コンフィギュレーションファイルの下部に格納される。設定確認は`running-config`で行う。

### `VTY(仮装端末)パスワード`
VTY(仮装端末)ポートに対するパスワードを**VTYパスワード**と呼ぶ。離れた場所からTCP / IPネットワーク経由でTelnetを使用してルータやスイッチに管理接続できる。一般的なCatalystスイッチはVTYポートを16個、ルータはそれ以上持っており、各ポートには0から始まる連番でライン(回線)番号が付けられている。  
**VTY(仮装端末)パスワードの設定**  
`(config)#line vty <First-number> [<Last-line-number>]`  
`(config-line)#password <password>`  
`(config-line)#login`  
First-number:先頭のライン番号を指定  
Last-line-number:最後のラインを指定(オプション)。省略した場合は1つのポートのみ設定される。先頭から最後の範囲数だけ同時にTelnet / SSH接続が可能になる  
1個のVTYポートだけに設定する場合は`line vty 0`、5個のVTYポートに設定する場合は`line vty 0 4`でラインコンフィギュレーションに移行できる。Telnetクライアントは、ルータやスイッチにEXEC接続するため使用するVTYのライン番号を選択できない。IOSはTelnet接続の要求があると、その時点で空いている最も小さい番号を割り当てる。

### `特権モードのパスワード`
ユーザEXECモードから特権EXECモードへ移行するときに要求されるパスワード。特権モードのパスワードを設定すると、特権EXECモードと各種コンフィギュレーションモードを保護することができ、パスワード設定には次の2つがある。  
イネーブルパスワード:設定したパスワードがプレーンテキストの状態でコンフィギュレーションファイルに格納  
イネーブルシークレットパスワード:設定したパスワードがMD5(一方向ハッシュ関数)アルゴリズムでハッシュ処理(元の文字列の推定は不可)された状態でコンフィギュレーションファイルに格納。通常はこちらを使用する  
**イネーブルパスワードの設定**  
`(config)#enable password <password>`  
**イネーブルシークレットパスワードの設定**  
`(config)#enable secret <password>`  
両方設定した場合、イネーブルシークレットパスワードが優先される。`running-config`コマンドの結果に出力される。「enable secret 5 pass…」のようになし、5は暗号化レベル(MD5)を示す。

### `コンフィギュレーションファイルのパスワード暗号化`

> |コンソールパスワード                            |VTYパスワード|
> |---------------------------------------------|-----------|
> |デフォルトはloginなし</br>0番ポート1つ(常にline 0)|デフォルトはloginあり</br>複数の仮想ポート</br>line vty 0:1台だけログイン</br>line vty 0 4:最大5台まで|
>
> loginコマンドなし(認証機能無効):パスワードなしでログインできる  
> loginコマンドあり(認証機能有効):パスワードなしではログインできない
