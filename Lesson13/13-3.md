# スイッチのセキュリティ機能
スイッチのポートに対する攻撃からホストを保護するために、基本的なセキュリティ対策を実施する必要がある

### `スイッチのポートセキュリティ`
スイッチの物理ポートに許可するMACアドレスを登録し、許可していない送信元MACアドレスのフレームを破棄する機能。ポートセキュリティによって、特定ポートに接続できるのは正規のコンピュータ(MACアドレス)だけに制限し、不正に接続されたコンピュータからのフレームを遮断できる。レイヤ2の制限に基づいて実装できるセキュリティ機能。

- セキュアMACアドレスのタイプ  
ポートセキュリティを有効にしたいポート(セキュアポート)で許可されたMACアドレスのこと。スイッチは以下のMACアドレスのタイプをサポートしている。  
スタティック:手動で登録し、MACアドレスと`running-config`に保存される  
ダイナミック:フレームを受信するごとで動的に送信元MACアドレスがMACアドレステーブルにのみ保存され、スイッチの再起動時に消去される  
スティッキー:フレームを受信することで動的に送信元MACアドレスがMACアドレステーブルと`running-config`に保存される

- スティッキーラーニング  
動的に学習したMACアドレステーブルをスティッキーセキュアMACアドレスに変換することで、`running-config`に保存する。`copy running-config startup-config`コマンドでコンフィギュレーションをNVRAMへ保存するとスイッチの再起動後も情報は失われない。

- セキュリティ違反  
ポートセキュリティは、許可されていない送信元MACアドレスのフレームを違反フレームとして扱う。ポートセキュリティが有効なセキュアポートでは、下記の状況が発生するとセキュリティ違反となる。  
・違反フレームを受信した場合:MACアドレスフレームに最大数のセキュアMACアドレスが保存されている状態で違反フレームを受信すると、セキュリティ違反になる。  
・セキュアMACアドレスが別のセキュアポートで使用された場合:あるセキュアポートで登録されたセキュアMACアドレスアドレスを、同じVLANの別のセキュアポートで送信元MACアドレスのフレームとして受信すると、セキュリティ違反になる。セキュリティ違反が発生した時の対処として次の違反モードがある。</br>

|違反モード     |違反フレームの破棄|SNMPトラップ/Sylogメッセージの送信|違反カウンタの増加|ポートシャットダウン     |
|-------------|---------------|------------------------------|---------------|----------------------|
|protect      |あり            |なし                           |なし           |なし                   |
|restrict     |あり            |あり                           |あり           |なし                   |
|shutdown     |あり            |あり                           |あり           |なし                   |
|shutdown vlan|あり            |あり                           |あり           |違反が発生したVLANのみあり|

- ポートセキュリティの設定

1.アクセスポートまたはトランクポートに設定

2.セキュアMACアドレスの最大数を指定

3.違反モードの指定

4.セキュアMACアドレスの指定

5.ポートセキュリティの有効化

- ポートセキュリティの検証

- err-disabled状態からの回復

### `未使用ポートの保護`

---
> MACアドレスを利用するポートセキュリティはスイッチの機能。ルータには設定できない
