# 管理アクセスに対するセキュリティの強化
ユーザ認証やSSH、ACLを利用した管理アクセス制御でセキュリティ強化をできる

### `ユーザ認証による管理アクセスの保護`
コンソールポートやVTY(仮装端末)ポートを使用して管理アクセスするとき、ユーザ名とパスワードの入力を要求し、ユーザ認証するように構成できる。ユーザ認証を利用すると、複数の管理者でパスワードを共有する必要がなくなる。また、ルータ(スイッチ)へのログインが許可された正規ユーザなのかを判別できる。ユーザ認証を行うには、事前にユーザアカウント(ユーザ情報)をデータベースとして用意する必要がある。ユーザデータベースをローカルで保持するローカル認証と、認証サーバを利用する方法がある。

- ローカル認証  
ユーザアカウントをコンフィギュレーションファイル内に格納してルータ(スイッチ)自身で認証を行う。設定・導入が容易なメリットがある一方、ネットワークデバイスごとにユーザデータベースを保持するため、ユーザ情報の管理に手間がかかるといったデメリットもある。</br></br>
1.ユーザアカウントの作成  
ローカル認証を行う場合、ユーザアカウントに**username**コマンドでユーザ名とパスワードの組み合わせを登録する。**password**ではコンフィギュレーションファイルへ保存時にパスワードは暗号化されないが、**secret**だとパスワードは暗号化される。削除の際はコマンドの先頭にnoを付けて実行する。  
**ユーザアカウント(ユーザ情報)の作成**  
`(config)#username <name> password(またはsecret) <password>`  
name:管理アクセスを行うユーザ名を指定  
password:ユーザごとに異なるパスワードを指定。大文字小文字の区別がされる</br></br>
2.ローカル認証の有効化  
`line console 0`や`line-number`コマンドでそれぞれのラインコンフィギュレーションモードから**login local**コマンドでローカル認証機能を有効にする。noを先頭につけてコマンドを実行するとローカル認証を無効にする。  
**ローカル認証の有効化**  
`(config-line)#login local`

- 認証サーバ(RADIUS / TACACS+)  
ネットワークやシステムにログインを試行してきたユーザが、アクセス許可を受けている正規のユーザか判別するためのサーバのこと。ルータ(スイッチ)のコンソールポートやVTYポートに対して管理アクセスする際に、外部の認証サーバを利用して認証するように構成できる。ユーザデータベースをサーバ上で一元管理するため、個々の機器でユーザアカウントを作成する必要がない。通常、ルータ(スイッチ)は**RADIUS**や**TACACS+**などのセキュリティプロトコルを使用して認証サーバへ問い合わせを行う。それぞれのプロトコルは、サーバのデータベースを利用してAAA機能を提供する。**AAA**は、Authentication(認証)、Authorization(許可)、Accounting(アカウンティング)の頭文字で、3つのセキュリティ機能を提供する仕組みを表す。

- 特権  
**特権レベル**を使用してルータ(スイッチ)にログインする管理者に対して使用可能なコマンドを制限することができるセキュリティ機能が提供されている。0から15までの最大16段階で、数値が大きいほど強い権限が与えられ、3つの特権レベルが存在している。</br>

|特権レベル|説明                                                                 |プロンプト|
|---------|--------------------------------------------------------------------|--------|
|0        |disable, enable, exit, help, logoutを含む                            |Router> |
|1        |特権なし。ログイン時のデフォルトレベルで、全てのユーザレベルコマンドを含む       |Router> |
|15       |特権あり。イネーブルモードに入ったあとのレベルで、全ての管理者レベルコマンドを含む|Router# |

**レベルを指定した特権パスワードの指定**  
`(config)#enable secret [level <level>] <password>`  
level:特権レベルを1から15の範囲で指定(オプション)  
levelを省略した`enable secret <password>`コマンドは、特権レベル15に対するパスワード設定の意味。enableやdisableコマンドを実行する際に引数を付加すると、入りたい特権レベルを指定できる。  
**現在の特権レベルを表示(mode:>, #, 特権レベル0では不可)**  
`#show privilege`  
コンソールやVTYのラインコンフィギュレーションモードでprivilege levelコマンドを使用すると、ログインする際の特権レベルを予め設定できる。設定しない場合、デフォルトは特権レベル1(ユーザレベル)でログインする。  
**特権レベルの設定**  
`(config-line)#privilege level <level>`  
level:ログイン時の特権レベルを0から15の範囲で指定。デフォルトは1  
**特権レベルを指定したユーザアカウントの作成**  
`(config)#username <name> [privilege <level>] [0 | 7(または5)] password(またはsecret) <password>`  
level:特権レベルを指定。デフォルトは1  
0:プレーンテキストでパスワードを入力する際に指定(オプション)。デフォルトは0  
7:Vigenereで暗号化した結果でパスワードを指定する際に指定(オプション)  
5:MD5で暗号化した結果でパスワードを設定する際に指定(オプション)

### `SSHを使用した管理アクセス`

1.ユーザアカウント(ユーザ情報)の作成

2.ホスト名の設定

3.ドメイン名の設定

4.暗号鍵の生成

5.SSHバージョンの設定

6.SSHの許可

7.ローカル認証の有効化

- SSHサーバ機能の検証

### `ACLを使用したVTYアクセス制御`

- VTYアクセス制御の設定

1.標準ACLの作成

2.VTY回線に対してACLを適用

### `EXECセッションのタイムアウト`

### `バナーメッセージの設定`

---
> line設定がloginのとき => `password`コマンドで認証  
> line設定がlogin localのとき => `username`コマンドで認証  
> usernameとlineは離れたところに表示される

> 管理者レベル(特権EXECモード)のデフォルトは特権レベル15  
> ルータにログインしたときデフォルトで特権レベル1  
> ローカル認証時にレベル15の権限を与えるときのコマンド:`(config)#username <name> privilege 15 password <password>`
