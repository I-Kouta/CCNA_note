# Cisco IOSの接続診断ツール
pingとtracerouteコマンドの操作について

### `ping`
**pingコマンド**を使用すると特定のノードとIP通信が可能かどうかを確認できる。指定したアドレスに対してICMPのエコー要求パケットを送信し、宛先からエコー応答が送信されるのを待機する。その結果によって宛先とのネットワーク接続の診断を行う。pingコマンドでは定義した時間内にエコー要求パケットが宛先に到着し、エコー応答を受信した場合にのみpingが成功したと判断される。ping実行時に表示される記号は下記の通り。

**pingコマンド(mode:#, >)**  
`#ping | <ip-address> | <hostname> |`

ip-address:接続性を確認する宛先のIPアドレスを指定  
hostname:接続性を確認する宛先のホスト名を指定

|引数|説明                                                                                              |
|---|--------------------------------------------------------------------------------------------------|
|!  |ICMPエコー応答を受信、ping成功                                                                        |
|.  |ICMPエコー応答を受信できずに時間が経過しタイムアウト。デフォルトは2s                                         |
|U  |ICMP宛先到達不能(Destination Unreachable)を受信。転送途中にあるルータに問題があり、ルーティングできない可能性あり|
|Q  |ICMP送信元抑制(Source Quench)を受信。宛先がビジー状態                                                    |
|M  |フラグメンテーションに失敗                                                                              |
|?  |パケットタイプが不明                                                                                   |
|&  |ICMP時間超過(Time Exceeded)を受信。ICMPエコーは破棄された                                                 |

### `拡張ping`
ルータから通常のpingコマンドを実行した場合、パケットの送信元アドレスは出力インターフェイスのIPアドレスになる。pingコマンドの後ろに引数を指定しないで実行すると**拡張ping**を開始する。これを使用するとパケットの送信元IPアドレスをルータ上の任意のIPアドレスに変更したり、送信するパケット数やサイズの変更、タイムアウト時間を変更したりすることができるため、より高度な検証を行うことができる。このコマンドは**特権EXECモードで動作する**。拡張pingコマンドで変更できる項目(フィールド)は以下の通り。  
・プロトコルの指定・pingの宛先ノードをアドレスまたはホスト名で指定・送信するパケットの数・パケットのサイズ・タイムアウト間隔・追加コマンドの指定・応答データの検証・データパターン・IPヘッダオプション指定・など

### `traceroute`
