# OSI参照モデル
通信プロトコルの位置付けや関連性を把握するのに役立つのに役立つ基本モデル。

### **`プロトコル`**
通信を行う上でのルール。通信時には必ず同じプロトコルを使用する。双方でプロトコルが異なる場合、データを正しくやり取りできない。様々な種類があり、たくさんのプロトコルが連携することによって実現している。連携するいくつかのプロトコルを体系的に組み合わせたものを、**ネットワークアーキテクチ**(**プロトコルスタック**、**プロトコルスイート**)と呼ぶ。
### **`OSI参照モデル`**
ネットワークで必要とされる機能を7つの階層(レイヤ)に分割したモデル。それぞれの階層の役割を果たすためのプロトコルを定義している。OSIは*Open Systems Interconnections*(開放型システム間相互接続)の略で、異なる機種間のデータ通信を実現するためにISO(*International Organization for Standardization*:国際標準化機構)によって策定された。  

メリット:  
・標準インターフェースを定義することにより、ベンダに依存せず相互接続できる  
・ネットワーク処理を役割で分割することでどの機能のプロトコルなのかが分かりやすい  
・ある階層のプロトコルを変更しても、他の階層のプロトコルに与える影響を最小限に留められる  
・新しいプロトコルの開発が容易になる  
ベンダ:製品を開発する会社(メーカー)。複数のベンダ製品を組み合わせて構築することをマルチベンダという。

|階層 |名前              |役割                                        |
|----|-----------------|--------------------------------------------|
|第7層|アプリケーション層  |ネットワークアプリケーションの機能を提供する       |
|第6層|プレゼンテーション層|データの表現形式を決定する                      |
|第5層|セッション層       |セッションの管理を行う                         |
|第4層|トランスポート層    |信頼性のある通信を提供する                     |
|第3層|ネットワーク層      |最適経路を決定し、エンドツーエンドの通信を行う    |
|第2層|データリンク層     |隣接するノードと通信を行う                      |
|第1層|物理層            |テーブルや電気信号など定義し、ビットを正しく伝送する|

- **物理層(レイヤ1)**:コンピュータとケーブルに接続し、0と1のデジタルデータを伝送メディア(信号を伝送する物理的媒体(伝送媒体)。有線と無線がある)で扱う信号に相互に変換する。電気的・機械的なハードウェアの物理仕様が定義されている。  
・コネクタの形状、ピンの数や配置  
・ケーブルの種類や長さ  
・電圧レベル、電圧変化  
・通信速度、符号化の方式  
符号化(*encoding*):データを一定の規則に基づいてビット化すること。音声や映像などのアナログデータをデジタルネットワークで伝送するには、アナログ信号をデジタル信号に変換する必要がある。↔︎複合(デコード):符号化されたデータを戻す処理のこと

- **★データリンク層(レイヤ2)**:同一リンク上に接続された隣接ノードと正しく通信する。通信相手を特定するための情報としてMACアドレスなどの**物理アドレス**が使用される。以下のことを定義している。データの送信元と宛先のMACアドレスによって出力ポートを決定する。  
・通信媒体にデータを送り出すときのタイミング  
・伝送中に発生したエラーの検出と対処方法  
・データ(フレーム)の構造  
・データの発信元および宛先の識別方法  
MACアドレス:ネットワーク機器を識別するために全世界で重複しないように割り当てられた48ビットのアドレス。16進数で12桁で表記され、イーサネットLANの物理層アドレスで、NICやルータなどのネットワーク機器に割り振られている。

- **★ネットワーク層(レイヤ3)**:異なるネットワークを相互接続し、エンドツーエンド(通信を行う二者間を結ぶ通信区間全体)で通信するための経路選択(ルーティング)を行う。データの転送先を決定するための情報としてIPアドレスなどの**論理アドレス**を使用する。以下のことを定義している。  
・データの送信元および宛先を識別するアドレスの割り当て方法  
・データ(パケット)の構造  
・経路選択(ルーティング)の方法  
・選択した経路上にデータを送出する方法  
IPアドレス:TCP/IPネットワークに接続されたコンピュータや通信機器に割り振られる識別番号。IPアドレスはネットワーク上の通信機器やコンピュータの住所に相当し、重複しないようにインターネット上では各国のNICが割り当ての管理を行っている。ルータで宛先IPアドレスを基に最適経路(ネクストホップ)を決定する。宛先IPアドレスが自分と同じ場合データを受け取る。

- **★トランスポート層(レイヤ4)**:データを確実に届けるための信頼性を提供する。  
・仮想回線(コネクション)の確立、維持、終了  
・フロー制御(受信側の状態に合わせて送信量を調整する)  
・順序制御(分割されたデータを受信側で元の順番に再構成する)  
・確認応答(データが正しく相手に届いたかどうか確認する)  
・再送制御(データが届かなかった場合に再送信する)  

- **セッション層(レイヤ5)**:通信を行うプロセス(プログラム)同士の論理的な通信路(セッション)の確立・維持・終了などを定義している。
セッション:2つのシステム間で実行される通信の論理的な接続の開始から終了までを指す。HPを参照するとき、Webブラウザを起動しURLを入力して実行すると通信が開始され、ページが全て表示されると通信が終了する。1台のコンピュータで様々なアプリケーションが同時に通信できるのは、セッションが適切に管理されているため。

- **プレゼンテーション層(レイヤ6)**:データを受信側でも正しく読み取れるようにするため、表現形式を定義、共通の形式にデータを変換する。文字コード(ASCII、EBCDIC)、静止画像(GIF、JPEG)、動画(MPEG)などを規定している。異なる文字コードを使用しているコンピュータ同士が通信すると文字化けが発生する。必要に応じてデータ圧縮や暗号化も行う。

- **アプリケーション層(レイヤ7)**:ユーザに最も近い層。利用するアプリケーションに対してネットワークサービスを提供する。電子メールやWebページの閲覧、ファイル転送などネットワークサービスに応じた様々なアプリケーション層プロトコルが存在する。  
電子メールの場合、相手のメールアドレス、件名、本文はメールソフトの決められたフィールドに入力しないといけず、これはアプリケーションプログラムで細かくルールを取り決められている。そのため、受信側で使用しているメールソフトが異なっていても件名や本文を決められたフィールドに正しく表示することができる。

### **`カプセル化・非カプセル化`**
### **`PDU`**
