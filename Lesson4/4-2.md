# サブネットワーク
ある1つのネットワークを複数に分割した小さなネットワークを指す。ネットワークの管理単位をいくつかの小さい単位に分割する仕組みをサブネット化を呼ぶ。

### `サブネットワークの利点`
・1つのネットワークに許容できるコンピュータの台数には限りがあるが、サブネットによって多くの端末をネットワークに接続できる  
・サブネット化によってブロードキャストドメインを分割できる  
・ネットワークで扱うトラフィックを局所化するので、全体的なパフォーマンスが改善される  
・ネットワーク構成が柔軟にでき、管理の手間も軽減できる  
・ネットワークサイズを小さくしてトラフィックを分離することで、ネットワークセキュリティの適用が容易になる

### `サブネット化`
1つのネットワークを小さなサブネットワークに分割する仕組み。サブネット化している状態でルーティングを行うためには、分割したサブネットを識別するための番号が必要。IPアドレスは32ビットの固定長、ネットワーク部はIANAによって割り当てられているため変更不可。そのためサブネットワーク部は**ホスト部のビットから**任意のビット長を借りて拡張する。利用するビット数は管理者によって決められる。ただしサブネットワーク部を1ビット多く拡張するたびに分割するサブネット数は増加するが、サブネット当たりのホストアドレス数は減少する。管理者は「必要なサブネット数と1サブネットに必要な最大ホストアドレス数」を考慮してサブネット化の計画を立てる必要がある。

・**サブネット数 = 2のs乗**(sはサブネットワーク部のビット数)  
・**ホストアドレス数 = (2のh乗) - 2**(hはホスト部のビット数)  
ホストアドレス数の計算では、必ずサブネットアドレス(ホスト部のビットが全て0)とブロードキャストアドレス(ホスト部のビットが全て1)の2つを除く。  
クラスCアドレスの場合、アドレス構成はネットワーク部が24ビット、ホスト部が8ビット。192.168.1.0のホスト部を2ビット使用してサブネット化した場合はサブネット数は4(2の2乗)、ホストアドレス数は62(2の6乗 - 2)。

・クラスCのサブネット化

|サブネット部のビット数(s)|サブネット数(2のs乗)|ホスト部のビット数|ホストアドレス数|
|---------------------|------------------|---------------|-------------|
|1                    |2                 |7              |126          |
|2                    |4                 |6              |62           |
|3                    |8                 |5              |30           |
|4                    |16                |4              |14           |
|5                    |32                |3              |6            |
|6                    |64                |2              |2            |
|7                    |128               |1              |0            |

・クラスBのサブネット化(まだ続く)

|サブネット部のビット数(s)|サブネット数(2のs乗)|ホスト部のビット数|ホストアドレス数|
|---------------------|------------------|---------------|-------------|
|1                    |2                 |15             |32,766       |
|2                    |4                 |14             |16,382       |
|3                    |8                 |13             |8,190        |
|4                    |16                |12             |4,094        |
|5                    |32                |11             |2,046        |
|6                    |64                |10             |1,022        |
|7                    |128               |9              |510          |
|8                    |256               |8              |254          |

・クラスAのサブネット化(まだ続く)

|サブネット部のビット数(s)|サブネット数(2のs乗)|ホスト部のビット数|ホストアドレス数|
|---------------------|------------------|---------------|-------------|
|1                    |2                 |23             |8,388,606    |
|2                    |4                 |22             |4,194,302    |
|3                    |8                 |21             |2,097,150    |
|4                    |16                |20             |1,048,574    |
|5                    |32                |19             |524,286      |
|6                    |64                |18             |262,142      |
|7                    |128               |17             |131,070      |
|8                    |256               |16             |65,534       |

- サブネット0、サブネット1の使用  
現在はサブネット0(全て0のサブネット)やサブネット1(全て1のサブネット)をを含むアドレス空間全体が利用できるようになっている。ネットワークアドレスをサブネット化したときに得られる最初のサブネットを**サブネット0**、最後のサブネットを**サブネット1**と呼ぶ。クラスCアドレス「192.168.1.0」を2ビットサブネット化した場合、「192.168.1.0」がサブネット0、「192.168.1.192」がサブネット1となる(2の6乗と7乗の和)。

- サブネットマスク  
IPアドレスの「先頭から何ビット目までがネットワークアドレスの部分か」を定義する32ビットの数値。IPアドレスと同じくオクテット(8ビット)で区切って10進数で表記する。ビット1はネットワーク部、0の部分はホスト部を表し、境界でネットワークアドレスを識別するため2進数で表現すると必ず1の連続と0の連続になる。サブネット化されていないネットワークのサブネットマスクは各クラスで下記のようになる。デフォルトのサブネットマスクは**ナチュラルマスク**とも呼ばれる。  
・デフォルトのサブネットマスク  
クラスA:255.0.0.0(11111111.00000000.00000000.00000000)  
クラスB:255.255.0.0(11111111.11111111.00000000.00000000)  
クラスC:255.255.255.0(11111111.11111111.11111111.00000000)  

サブネットワークの導入によって、IPアドレスにはサブネットマスクが併記されるようになった。これによりサブネット0のアドレスと元のネットワークアドレスを区別することができる。

・デフォルトの場合  
ネットワークアドレス:172.16.0.0  
サブネットマスク:255.255.0.0  
→ネットワーク部・ホスト部それぞれ16ビット

・8ビットサブネット化した場合  
ネットワークアドレス:172.16.0.0  
サブネットマスク:255.255.255.0  
→ネットワーク部が24ビット、ホスト部が8ビット

同じ「172.16.0.0」のアドレスであっても、サブネットマスクう見るとネットワークの長さを識別できる。クラスによって割り振られたアドレスを**クラスフルアドレス**、クラスの概念を廃したアドレスを**クラスレスアドレス**と呼ぶ。

- プレフィックス長  
IPアドレスのうちネットワークアドレスを示すビットの長さを**プレフィックス長**と呼び、「/24」のようにスラッシュの後ろにネットワーク部のビット数を書いて表記する。この表記のことを**CIDR**(*Classless Inter-Domain Routing*)表記ともいう。  
例:172.16.0.0 255.255.255.0 = 172.16.0.0/24

- オクテット内のサブネット化
