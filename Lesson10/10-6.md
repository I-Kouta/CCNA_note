# ACLのトラブルシューティング
特定の構成や要件で発生し得るトラブルの例を示し、showコマンドの出力からACL設定エラーを分析・問題解決を行うことが可能

### `トラブルシューティング例`  
要件:サブネット10.1.1.0 / 24からのIPパケットが、192.168.1.0 / 24へアクセスするのを拒否する。上記以外の全てのIPパケットの転送を許可する  
10.1.1.0 / 24(Fa0 / 0), 10.2.2.0 / 24(Fa0 / 1) --- RT1 (S0 / 0 / 0) --- RT2, 192.168.1.0 / 24(Fa0 / 0), 192.168.2.0 / 24(Fa0 / 1)

- 問題1.サブネット10.2.2.0 / 24のホストから192.168.1.0 / 24へアクセスできない  
原因:permitステートメントが存在しない  
RT2のFa0 / 0にACL1がアウトバウンドで適用されている。10.1.1.0 / 24からのアクセスを拒否する条件を設定し、それ以外からのアクセスを許可するための条件が存在しない。最終行には自動的に暗黙のdenyが存在するため、全てのIPパケットが拒否されてしまう。そのため、全てからのパケットを許可する条件を追加する必要がある。  
全てからのパケットを許可する:`access-list 1 permit any`

- 問題2.サブネット10.1.1.0 / 24のホストが192.168.2.0 / 24へアクセスできない  
原因:ACLの配置場所が間違っている  
ACL2がRT1のS0 / 0 / 0のアウトバウンドで適用されている。そのため、RT1はサブネット10.1.1.0 / 24からのIPパケットを、S0 /0 /0から転送するのを拒否する。標準ACLでは、パケットの送信元IPアドレスのみチェックする。宛先アドレスを条件には指定できないため、標準ACLはトラフィックの宛先近くに配置する必要がある。そのため、RT2のFa0 / 0のアウトバウンドに適用する必要がある。  
ACL2の適用を解除する:`RT1(config-if)#no ip access-group 2 out`  
RT2でACLを作成:`RT2(config)#access-list 2 deny 10.1.1.0 0.0.0.255`

- 問題3.サブネット10.1.1.0 / 24のホストが192.168.1.0 / 24へアクセスできてしまう  
原因:ワイルドカードが誤っている  
ワイルドカードマスクは指定したIPアドレスに対応するビットの値と照合する。ワイルドカードマスクに0を指定すると一致、1を指定すると無視になる。そのため、10.1.1.0 / 24からのアクセスを拒否するための条件は、0.0.0.255で指定する必要がある。  
ACL3の設定モードに移行:`RT2(config)#ip access-list standard 3`  
シーケンス番号10の条件を削除:`RT2(config-std-nacl)#no 10`  
シーケンス番号10で、10.1.1.0 / 24からのパケットを拒否`RT2(config-std-nacl)#10 deny 10.1.1.0 0.0.0.255`

- 問題4.10.2.2.0 / 24のホストが192.168.2.0 / 24へアクセスできない
