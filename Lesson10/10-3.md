# 番号付き標準ACL
標準ACLは、条件に送信元IPアドレスのみ指定できる。

### `番号付き標準ACLの作成`
番号付き標準ACLはコマンドでステートメント(条件文)を作成する。1つのACLに複数のステートメントを設定する場合は、同じACL番号でコマンドを実行する。追加のステートメントはリストの末尾に挿入される。先頭にnoを付けると、指定した番号のACL全体を削除する。  
**番号付き標準ACLの作成**  
`(config)#access-list <acl-number> {permit | deny | remark} <source> [<wildcard>] [log]`  
acl-number:標準ACLの番号を1 ~ 99、1300 ~ 1999の範囲で指定。同一ACLの場合は2行目以降のステートメントも同じ番号を使用する  
permit:条件に一致した場合に許可  
deny:条件に一致した場合に拒否  
remark:ACL内にコマンド分を挿入(100文字以内)  
source:送信元IPアドレスを指定  
wildcard:ワイルドカードマスクを指定。省略した場合は0.0.0.0が適用される  
log:パケットが条件に一致した場合にログメッセージを表示  

以下の例は、10.1.1.1(ホストA)と10.2.2.1(ホストD)からのパケットだけ外部ネットワークへのアクセスを禁止するという要件で、番号付き標準ACLを使用する(ホストAとホストDのスイッチは異なる)。

1.ACL番号の決定  
作成するACLの番号を決める。IPv4標準ACLの場合、1 ~ 99または1300 ~ 1999番の範囲から未使用の番号を1つ選択する。

2.「10.1.1.1からのパケットを拒否する」ステートメント作成  
送信元IPアドレスが10.1.1.1(ホストA)のパケットを拒否するためのステートメントを作成  
`(config)#access-list 1 deny 10.1.1.1 0.0.0.0`または  
`(config)#access-list 1 deny host 10.1.1.1`(0.0.0.0の場合はhostで省略できる)

3.「10.2.2.1からのパケットを拒否する」ステートメント作成  
同様に、送信元IPアドレスが10.2.2.1(ホストD)のパケットを拒否するためのステートメントを作成。ACL番号は必ず1行目を同じ必要がある。異なる番号だと別のリストが作成される  
`(config)#access-list 1 deny 10.2.2.1 0.0.0.0`または  
`(config)#access-list 1 deny host 10.2.2.1`

4.「全てのパケットを許可する」ステートメント作成  
ACLの最後には「暗黙のdeny」が存在するため、最低1つはpermitステートメントが必要。全てのパケットを許可するステートメントを作成する  
`(config)#access-list 1 permit 0.0.0.0 255.255.255.255`(これだと全てのアドレスを指定)または  
`(config)#access-list 1 permit any`(0.0.0.0 255.255.255.255とanyは同等)

### `ACLのインターフェイスへの適用`
作成したACLを**ip access-group**コマンドを使用してインターフェイスに適用すると、パケットフィルタリングが有効になる。別番号を指定したip access-groupコマンドを実行すると、元のACLが解除されて新しく指定したACLが適用される。インターフェイスからACL適用を解除するにはコマンドの先頭にnoを付ける。  
**番号付きACLをインターフェイスに適用**  
`(config-if)#ip access-group <acl-number> {in | out}`  
in:ACLを適用する方向をin(インバウンド)に指定。パケット着信時にACLと照合する  
out:ACLを適用する方向をout(アウトバウンド)に指定。パケット発進時にACLと照合する  
ACL1をS0/0/0のアウトバウンドに適用すると、指定したIPアドレスからの外部ネットワークへのアクセスを禁止できる。

|条件                                   |標準ACLステートメントの例                      |
|--------------------------------------|-------------------------------------------|
|IPアドレス「10.1.1.1」からのパケット許可   |`access-list 1 permit host 10.1.1.1`       |
|サブネット「10.2.2.0/24」からのパケット許可|`access-list 1 permit 10.2.2.0 0.0.0.255`  |
|「10.0.0.0/8」からのパケット拒否          |`access-list 1 deny 10.0.0.0 0.255.255.255`|
|「172.16.80.0/20」からのパケット許可      |`access-list 1 deny 172.16.80.0 0.0.15.255`|
|「192.168.1.8/30」からのパケット拒否      |`access-list 1 deny 172.168.1.8 0.0.0.3`   |
|「全てからのパケット許可                   |`access-list 1 permit any`                 |

---
> ACLを適用する際はトラフィックの流れ(方向)に注目して適切なインターフェイスと方向を選択する

> 番号付き標準ACLの設定  
> `(config)#access-list <acl-number> {permit | deny} <source> [<wildcard>]`(標準ACLでは0.0.0.0は省略可能)  
> `(config-if)#ip access-group <acl-number> {in | out}`
